import{ah as B,x as o,ab as k,a4 as u,a2 as $,c as t,aa as P,aD as g,b1 as T,a6 as m,ad as F,az as w,ay as f,bt as D,aC as N,a9 as j,a5 as C,ac as z,ag as L}from"./index-7qtL3Bw3.js";import{i as O,a as G,F as H,V as R}from"./VTimePicker-lqvTbZ9S.js";import{V as X}from"./VContainer-BtWKigHT.js";import{V as Y}from"./VDivider-DbTWzxOK.js";const q={__name:"schedule copy",setup(J){const{apiAuth:b}=L(),p=o([]),r=o(!1),c=o(""),d=o(""),v=o(""),i=o(""),s=o("12:00"),V=o(!1),x=o(""),n=o(null),E=o(""),y=o({plugins:[O,G],initialView:"dayGridMonth",editable:!0,events:p.value,displayEventTime:!1,dateClick:U,eventClick:I,eventDrop:A,eventMouseEnter:S});function S(a){const e=a.event;E.value=`劇本: ${e.title}<br>玩家: ${e.extendedProps.player}<br>角色: ${e.extendedProps.chara}<br>時間: ${e.extendedProps.time}`;const l=document.createElement("div");l.innerHTML=E.value,l.style.position="absolute",l.style.backgroundColor="rgba(0, 0, 0, 0.7)",l.style.color="white",l.style.padding="10px",l.style.borderRadius="4px",l.style.zIndex="1000",l.style.top=`${a.jsEvent.pageY}px`,l.style.left=`${a.jsEvent.pageX}px`,document.body.appendChild(l),a.el.addEventListener("mouseleave",()=>{l.remove()})}function U(a){c.value="新增行程",d.value="",v.value="",i.value="",s.value="12:00",x.value=a.dateStr,n.value=null,r.value=!0}function I(a){c.value="編輯行程",d.value=a.event.title,v.value=a.event.extendedProps.player,i.value=a.event.extendedProps.chara,n.value=a.event,r.value=!0}async function M(){try{if(!d.value.trim()){alert("行程名稱不能為空");return}n.value?(n.value.setProp("title",d.value),n.value.setExtendedProp("player",v.value),n.value.setExtendedProp("chara",i.value),n.value.setExtendedProp("time",s.value)):(y.value.events.push({id:String(Date.now()),title:d.value,player:v.value,chara:i.value,time:s.value,date:x.value}),console.log(y.value.events),await b.post("/schedule",{title:d.value,player:v.value,chara:i.value,time:s.value,date:x.value}))}catch(a){console.log(a)}r.value=!1}function h(){if(n.value&&confirm(`確定要刪除「${n.value.title}」嗎？`)){const a=n.value.id;n.value.remove(),p.value=p.value.filter(e=>e.id!==a),n.value=null,r.value=!1}}function A(a){alert(`行程「${a.event.title}」已移動到 ${a.event.start.toISOString().split("T")[0]}`)}return(async()=>{try{const{data:a}=await b.get("/schedule");console.log(a.result),p.value.push(...a.result),console.log(p.value)}catch(a){console.log(a)}console.log()})(),(a,e)=>($(),k(X,null,{default:u(()=>[t(g,{class:"calendar-wrapper","max-width":"800px"},{default:u(()=>[t(P(H),{options:y.value},null,8,["options"])]),_:1}),t(D,{modelValue:r.value,"onUpdate:modelValue":e[9]||(e[9]=l=>r.value=l),"max-width":"400px"},{default:u(()=>[t(g,null,{default:u(()=>[t(T,null,{default:u(()=>[m(F(c.value),1)]),_:1}),t(w,null,{default:u(()=>[t(f,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value=l),label:"劇本名稱"},null,8,["modelValue"]),t(f,{modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=l=>v.value=l),label:"玩家名稱"},null,8,["modelValue"]),t(f,{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=l=>i.value=l),label:"角色名稱"},null,8,["modelValue"]),t(f,{modelValue:s.value,"onUpdate:modelValue":e[3]||(e[3]=l=>s.value=l),label:"選擇時間",readonly:"",onClick:e[4]||(e[4]=l=>V.value=!0)},null,8,["modelValue"]),t(D,{modelValue:V.value,"onUpdate:modelValue":e[7]||(e[7]=l=>V.value=l),"max-width":"380px"},{default:u(()=>[t(g,null,{default:u(()=>[t(T,null,{default:u(()=>e[10]||(e[10]=[m("選擇時間")])),_:1}),t(w,null,{default:u(()=>[t(P(R),{modelValue:s.value,"onUpdate:modelValue":[e[5]||(e[5]=l=>s.value=l),e[6]||(e[6]=l=>V.value=!1)],format:"24hr"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(N,null,{default:u(()=>[t(j),n.value?($(),k(C,{key:0,color:"red",onClick:h},{default:u(()=>e[11]||(e[11]=[m("刪除")])),_:1})):z("",!0),t(Y),t(C,{color:"grey",onClick:e[8]||(e[8]=l=>r.value=!1)},{default:u(()=>e[12]||(e[12]=[m("取消")])),_:1}),t(C,{color:"primary",onClick:M},{default:u(()=>e[13]||(e[13]=[m("確定")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},ee=B(q,[["__scopeId","data-v-b51f5929"]]);export{ee as default};
